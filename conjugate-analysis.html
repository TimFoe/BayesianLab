<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Conjugate analysis | Bayes at OeAW Summerschool: Exercises (Solutions)</title>
  <meta name="description" content="3 Conjugate analysis | Bayes at OeAW Summerschool: Exercises (Solutions)" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Conjugate analysis | Bayes at OeAW Summerschool: Exercises (Solutions)" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Conjugate analysis | Bayes at OeAW Summerschool: Exercises (Solutions)" />
  
  
  

<meta name="author" content="Tim Foeckersperger, Helga Wagner" />


<meta name="date" content="2019-08-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="short-recap.html">
<link rel="next" href="mcmc-methods.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="necessary-packages-and-programs.html"><a href="necessary-packages-and-programs.html"><i class="fa fa-check"></i><b>1</b> Necessary packages and programs</a></li>
<li class="chapter" data-level="2" data-path="short-recap.html"><a href="short-recap.html"><i class="fa fa-check"></i><b>2</b> Short recap</a></li>
<li class="chapter" data-level="3" data-path="conjugate-analysis.html"><a href="conjugate-analysis.html"><i class="fa fa-check"></i><b>3</b> Conjugate analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="conjugate-analysis.html"><a href="conjugate-analysis.html#exercise-1-rare-disease---posterior-inference-for-the-binomial-model"><i class="fa fa-check"></i><b>3.1</b> Exercise 1: Rare disease - Posterior inference for the Binomial model</a></li>
<li class="chapter" data-level="3.2" data-path="conjugate-analysis.html"><a href="conjugate-analysis.html#exercise-2-children-data---posterior-inference-for-the-poisson-model"><i class="fa fa-check"></i><b>3.2</b> Exercise 2: Children data - Posterior inference for the Poisson model</a></li>
<li class="chapter" data-level="3.3" data-path="conjugate-analysis.html"><a href="conjugate-analysis.html#exercise-3-midge-data---normal-model-with-known-variance"><i class="fa fa-check"></i><b>3.3</b> Exercise 3: Midge data - Normal model with known variance</a></li>
<li class="chapter" data-level="3.4" data-path="conjugate-analysis.html"><a href="conjugate-analysis.html#exercise-4-midge-data---normal-model-mean-and-variance-unknown"><i class="fa fa-check"></i><b>3.4</b> Exercise 4: Midge data - Normal model, mean and variance unknown</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mcmc-methods.html"><a href="mcmc-methods.html"><i class="fa fa-check"></i><b>4</b> MCMC methods</a><ul>
<li class="chapter" data-level="4.1" data-path="mcmc-methods.html"><a href="mcmc-methods.html#exercise-5-gibbs-sampling---linear-regression-analysis-for-the-oxygen-uptake-data"><i class="fa fa-check"></i><b>4.1</b> Exercise 5: Gibbs sampling - Linear regression analysis for the Oxygen uptake data</a></li>
<li class="chapter" data-level="4.2" data-path="mcmc-methods.html"><a href="mcmc-methods.html#exercise-6-gibbs-sampling-with-data-augmentation-probit-model-for-the-pima-indian-data"><i class="fa fa-check"></i><b>4.2</b> Exercise 6: Gibbs sampling with data augmentation: Probit model for the Pima indian data</a></li>
<li class="chapter" data-level="4.3" data-path="mcmc-methods.html"><a href="mcmc-methods.html#exercise-7-metropolis-hastings-for-sampling-from-a-student-distribution"><i class="fa fa-check"></i><b>4.3</b> Exercise 7: Metropolis-Hastings for sampling from a Student-distribution</a></li>
<li class="chapter" data-level="4.4" data-path="mcmc-methods.html"><a href="mcmc-methods.html#exercise-8-logit-model-for-the-pima-indian-data-with-rjags"><i class="fa fa-check"></i><b>4.4</b> Exercise 8: Logit model for the Pima indian data with rjags</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i><b>5</b> Sources</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayes at OeAW Summerschool: Exercises (Solutions)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conjugate-analysis" class="section level1">
<h1><span class="header-section-number">3</span> Conjugate analysis</h1>
<div id="exercise-1-rare-disease---posterior-inference-for-the-binomial-model" class="section level2">
<h2><span class="header-section-number">3.1</span> Exercise 1: Rare disease - Posterior inference for the Binomial model</h2>
<p>Suppose we are interested in the prevalence <span class="math inline">\(\theta\)</span> of a rare disease <span class="math inline">\(\theta \in \Theta = [0,1]\)</span>. n people were checked for infection and y is the number of infected in the sample (Y|<span class="math inline">\(\theta \sim BiNom(n,\theta))\)</span>. The prior distribution for <span class="math inline">\(\theta\)</span> is a Beta distribution <span class="math inline">\(B(a, b)\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Plot the probability function of y for <span class="math inline">\(\theta\)</span> = 0.02, 0.1, 0.2 and n = 20 (in one plot).</li>
</ol>
<p>HINTS:
The probability mass function of a binomial distribution with parameters <em>size</em> and <em>prob</em> is implemented in function <em>dbinom()</em>, see ?dbinom for details.
Use type = “h” for the plot.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">y &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">15</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">fy0<span class="fl">.02</span> &lt;-<span class="st"> </span><span class="kw">dbinom</span>(y, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="fl">0.02</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">fy0<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">dbinom</span>(y, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">fy0<span class="fl">.2</span>  &lt;-<span class="st"> </span><span class="kw">dbinom</span>(y, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="kw">plot</span>(y <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>, fy0<span class="fl">.02</span>, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">     <span class="dt">xlab =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;pmf&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>),</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">     <span class="dt">main =</span> <span class="st">&quot;Probability mass function of y|theta&quot;</span>)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="kw">lines</span>(y, fy0<span class="fl">.1</span>, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="kw">lines</span>(y <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>, fy0<span class="fl">.2</span>, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;theta = 0.02&quot;</span>, <span class="st">&quot;theta = 0.1&quot;</span>, <span class="st">&quot;theta = 0.2&quot;</span>),</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="Bayes_OeAWSummerschool_Exercises_Solutions_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Plot the prior and posterior distribution of <span class="math inline">\(\theta\)</span> for n = 20 and y = 0. Consider two scenarios with different hyperparameters (a1 and b1 for Scenario 1, a2 and b2 for Scenario 2) for the prior distribution of <span class="math inline">\(\theta\)</span>:</li>
</ol>
<ul>
<li><p>a1 = b1 = 1 (i.e. <span class="math inline">\(\theta_1 \sim B(a_1, b_1)\)</span>)</p></li>
<li><p>a2 = 2, b2 = 20 (i.e. <span class="math inline">\(\theta_2 \sim B(a_2, b_2)\)</span>)</p></li>
</ul>
<p>HINT:
The beta distribution with parameters <em>shape1 = a</em> and <em>shape2 = b</em> is implemeted
with functions <em>dbeta</em>, <em>pbeta</em>, <em>qbeta</em> and <em>rbeta</em> as described above.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">theta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#Prior and posterior a1=1 and b1=1 </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">a1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">b1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">a1n &lt;-<span class="st"> </span>a1 <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">b1n &lt;-<span class="st"> </span>b1 <span class="op">+</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">p.theta.prior1 &lt;-<span class="st"> </span><span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> a1, <span class="dt">shape2 =</span> b1)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">p.theta.posterior1 &lt;-<span class="st"> </span><span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> a1n, <span class="dt">shape2 =</span> b1n)</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="kw">plot</span>(theta, p.theta.prior1, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;theta&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Density&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,n),</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">     <span class="dt">main =</span> <span class="st">&quot;Prior/Posterior distribution of theta (Scenario 1)&quot;</span>)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="kw">lines</span>(theta , p.theta.posterior1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Prior&quot;</span>, <span class="st">&quot;Posterior&quot;</span>),</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="Bayes_OeAWSummerschool_Exercises_Solutions_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">#Prior and posterior for a2=2 and b2=20 </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">a2 &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">b2 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">a2n &lt;-<span class="st"> </span>a2 <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">b2n &lt;-<span class="st"> </span>b2 <span class="op">+</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">p.theta.prior2 &lt;-<span class="st"> </span><span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> a2, <span class="dt">shape2 =</span> b2)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">p.theta.posterior2 &lt;-<span class="st"> </span><span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> a2n, <span class="dt">shape2 =</span> b2n)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="kw">plot</span>(theta, p.theta.prior2, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;theta&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Density&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,n),</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">     <span class="dt">main =</span> <span class="st">&quot;Prior/Posterior distribution of theta (Scenario 2)&quot;</span>)</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="kw">lines</span>(theta , p.theta.posterior2, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Prior&quot;</span>, <span class="st">&quot;Posterior&quot;</span>),</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="Bayes_OeAWSummerschool_Exercises_Solutions_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Compare how the hyperparameters of the prior distribution of <span class="math inline">\(\theta\)</span> influence the posterior distribution.</li>
</ol>
<ul>
<li>Scenario 1: Flat prior, no prior information on <span class="math inline">\(\theta\)</span>: Posterior is infinity at <span class="math inline">\(\theta=0\)</span>.</li>
<li>Scenario 2: With a = 2 and b = 20, some information of prior experiments is provided. Posterior is unimodal.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>For n = 20 compute <span class="math inline">\(E(\theta|y = 0)\)</span>, mode(<span class="math inline">\(\theta\)</span>|y = 0), sd(<span class="math inline">\(\theta\)</span>|y = 0) and P(<span class="math inline">\(\theta\)</span> &lt; 0.1|y = 0) for a = b = 1 and a = 2, b = 20.</li>
</ol>
<p><span class="math display">\[E(\theta|y = 0) = \frac{a_n}{a_n+b_n}\]</span></p>
<p><span class="math display">\[Mode(\theta|y = 0) = \frac{a_n-1}{a_n+b_n-2} \text{ for } a_n, b_n &gt; 1 \]</span></p>
<p><span class="math display">\[sd(\theta|y = 0) = \sqrt{\frac{a_n b_n}{(a_n+b_n+1) (a_n+b_n)^2} }\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># Prior1 1 (a0 = 1, b0 = 1)</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">a0 &lt;-<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb5-6" data-line-number="6">b0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co"># Posterior Parameters</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">an &lt;-<span class="st"> </span>a0 <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">bn &lt;-<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">post.exp &lt;-<span class="st"> </span>an<span class="op">/</span>(an <span class="op">+</span><span class="st"> </span>bn) <span class="co"># posterior expectation</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">post.mode &lt;-<span class="st">  </span><span class="ot">NA</span> <span class="co"># Mode does not exist, see plot of posterior distribution</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14">post.sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>((an <span class="op">*</span><span class="st"> </span>bn)<span class="op">/</span>((an <span class="op">+</span><span class="st"> </span>bn <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span>(an <span class="op">+</span><span class="st"> </span>bn)<span class="op">^</span><span class="dv">2</span>)) <span class="co">#posterior sd</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15">post.p &lt;-<span class="st"> </span><span class="kw">pbeta</span>(<span class="fl">0.1</span>, an, bn) <span class="co"># posterior probability  p(theta &lt; 0.1| Y = 0)</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16">(<span class="kw">data.frame</span>(post.exp, post.mode, post.sd, post.p))</a></code></pre></div>
<pre><code>##     post.exp post.mode    post.sd   post.p
## 1 0.04545455        NA 0.04343332 0.890581</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Prior 2 (a0 = 2, b0 = 20)</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">a0 &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">b0 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co"># Posterior Parameters</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">an &lt;-<span class="st"> </span>a0 <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">bn &lt;-<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">post.exp &lt;-<span class="st"> </span>an<span class="op">/</span>(an <span class="op">+</span><span class="st"> </span>bn) <span class="co"># posterior expectation</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">post.mode &lt;-<span class="st"> </span>(an <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span>(an <span class="op">+</span><span class="st"> </span>bn <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)   <span class="co"># posterior mode</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11">post.sd &lt;-<span class="st">  </span><span class="kw">sqrt</span>((an <span class="op">*</span><span class="st"> </span>bn)<span class="op">/</span>((an <span class="op">+</span><span class="st"> </span>bn <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span>(an <span class="op">+</span><span class="st"> </span>bn)<span class="op">^</span><span class="dv">2</span>)) <span class="co">#posterior sd</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">post.p &lt;-<span class="st"> </span><span class="kw">pbeta</span>(<span class="fl">0.1</span>, an, bn) <span class="co"># posterior probability  p(theta &lt; 0.1| Y = 0)</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">(<span class="kw">data.frame</span>(post.exp, post.mode, post.sd, post.p))</a></code></pre></div>
<pre><code>##     post.exp post.mode    post.sd    post.p
## 1 0.04761905     0.025 0.03247592 0.9260956</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Compute an equally tailed and an HPD (highest posterior density) 95%-credibility interval for the parameter <span class="math inline">\(\theta\)</span> in the second scenario and compare the length of these credibility intervals.</li>
</ol>
<p>HINT:
Use quantiles of the beta distribution for the equal tailed intervall;<br />
for the HPD-interval with a Beta posterior, you can use the function <em>betaHPD</em>
(in R package <em>pscl</em>)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;pscl&quot;</span>)</a></code></pre></div>
<pre><code>## Classes and Methods for R developed in the
## Political Science Computational Laboratory
## Department of Political Science
## Stanford University
## Simon Jackman
## hurdle and zeroinfl functions by Achim Zeileis</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co"># Prior</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">a0 &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">b0 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co"># Posterior Parameters</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9">an &lt;-<span class="st"> </span>a0 <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">bn &lt;-<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#Equally sized CI (Use the quantiles of the beta posterior distribution)</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13">CI1 &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>), <span class="dt">shape1 =</span> an, <span class="dt">shape2 =</span> bn)</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">CI1</a></code></pre></div>
<pre><code>## [1] 0.005963118 0.128554020</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">#HPD interval</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">CI2 &lt;-<span class="st"> </span><span class="kw">betaHPD</span>(an, bn, <span class="dt">p=</span>.<span class="dv">95</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">CI2</a></code></pre></div>
<pre><code>## [1] 0.001175534 0.111143867</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co">#Compare length </span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">diff</span>(CI1)</a></code></pre></div>
<pre><code>## [1] 0.1225909</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">diff</span>(CI2)</a></code></pre></div>
<pre><code>## [1] 0.1099683</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co">#By definition the HPD interval is shorter</span></a></code></pre></div>
</div>
<div id="exercise-2-children-data---posterior-inference-for-the-poisson-model" class="section level2">
<h2><span class="header-section-number">3.2</span> Exercise 2: Children data - Posterior inference for the Poisson model</h2>
<p>The file “children.RData” contains information of how many pedestrians (6-10 years old) were killed or seriously injured in an Austrian city over the time of 16 years.
As the data are count data we assume that the number Y of children killed or seriously
injured follows a Poisson distribution with parameter <span class="math inline">\(\lambda\)</span>: <span class="math display">\[Y|\lambda \sim Poisson(\lambda).\]</span> The conjugate prior for a Poisson likelihood is a Gamma distribution with hyperparameters a and b <span class="math inline">\(\mathcal{G}(a_0,b_0)\)</span>, thus use <span class="math inline">\(\lambda \sim \mathcal{G}(a_0,b_0)\)</span></p>
<ol style="list-style-type: decimal">
<li>Load the data “children.RData” running the command below.</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;children.RData&quot;</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">children &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">y =</span> children<span class="op">$</span>y, <span class="dt">months =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">year =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>, <span class="dt">each =</span> <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">children[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,] <span class="co">#first 10 rows of the data</span></a></code></pre></div>
<pre><code>##    y months year
## 1  1      1    1
## 2  1      2    1
## 3  2      3    1
## 4  1      4    1
## 5  4      5    1
## 6  5      6    1
## 7  2      7    1
## 8  2      8    1
## 9  1      9    1
## 10 5     10    1</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Derive the posterior distribution of <span class="math inline">\(\lambda\)</span>.</li>
</ol>
<p>The result is again a Gamma distribution with updated parameters <span class="math inline">\(a_n = a_0 + n \bar{y}\)</span> and <span class="math inline">\(b_n = b_0 + n\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Plot the prior and the posterior for hyperparameters <span class="math inline">\(a_0 = 1\)</span> and <span class="math inline">\(b_0 = 1\)</span>.</li>
</ol>
<p>Prior distribution: <span class="math display">\[\mathcal{G} (1,1)\]</span></p>
<p>Posterior distribution: <span class="math display">\[\mathcal{G}(1+n \bar{y}, 1+n)\]</span></p>
<p>HINT:
The first column of the data.frame <em>children</em> can be extracted by data.frame[,1]. The mean of a vector can be calculated by the function <em>mean(…)</em>.
<em>nrow(…)</em> returns the number of rows in a data.frame.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># Prior parameters </span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">a0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">b0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">y.mean &lt;-<span class="st"> </span><span class="kw">mean</span>(children[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(children)</a>
<a class="sourceLine" id="cb22-7" data-line-number="7"></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co"># posterior parameters</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9">an &lt;-<span class="st"> </span>a0 <span class="op">+</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span>y.mean</a>
<a class="sourceLine" id="cb22-10" data-line-number="10">bn &lt;-<span class="st"> </span>b0 <span class="op">+</span>n </a>
<a class="sourceLine" id="cb22-11" data-line-number="11">lam &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb22-12" data-line-number="12"></a>
<a class="sourceLine" id="cb22-13" data-line-number="13">lambda.prior &lt;-<span class="st"> </span><span class="kw">dgamma</span>(lam, <span class="dt">shape =</span> a0, <span class="dt">rate =</span> b0)</a>
<a class="sourceLine" id="cb22-14" data-line-number="14">lambda.posterior &lt;-<span class="st"> </span><span class="kw">dgamma</span>(lam, <span class="dt">shape =</span> an, <span class="dt">rate =</span> bn)</a>
<a class="sourceLine" id="cb22-15" data-line-number="15"></a>
<a class="sourceLine" id="cb22-16" data-line-number="16"><span class="kw">plot</span>(lam, lambda.prior, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;lambda&quot;</span>,</a>
<a class="sourceLine" id="cb22-17" data-line-number="17">     <span class="dt">ylab =</span> <span class="st">&quot;Density&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>) , <span class="dt">main =</span> <span class="st">&quot;Prior/Posterior distribution of lambda&quot;</span>)</a>
<a class="sourceLine" id="cb22-18" data-line-number="18"><span class="kw">lines</span>(lam , lambda.posterior, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb22-19" data-line-number="19"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Prior&quot;</span>, <span class="st">&quot;Posterior&quot;</span>),</a>
<a class="sourceLine" id="cb22-20" data-line-number="20">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="Bayes_OeAWSummerschool_Exercises_Solutions_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>In October of the 8th year (from the 94th observation on) a legal amendment was introduced that gave the priority to pedestrians. In order to evaluate if the change of law effected the number of seriously injured or killed pedestrians one can assume that:</li>
</ol>
<p><span class="math display">\[Y_i \sim P (\lambda_1) \text{ for i } \leq \text{93}\]</span>
<span class="math display">\[Y_i \sim P (\lambda_2) \text{ for i &gt; 94}\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># legal amendment =&gt; ev.  structural break after month 9 in year 8 </span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">struct.break &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">row.names</span>(children[children<span class="op">$</span>months <span class="op">==</span><span class="st"> </span><span class="dv">9</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="st">                                                </span>children<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">8</span>,]))</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co"># data before legal amendment</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5">child.before &lt;-<span class="st"> </span>children[<span class="dv">1</span> <span class="op">:</span><span class="st"> </span>struct.break,]</a>
<a class="sourceLine" id="cb23-6" data-line-number="6"></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co"># data after legal amendment</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8">child.after &lt;-<span class="st"> </span>children[(struct.break<span class="op">+</span><span class="dv">1</span>) <span class="op">:</span><span class="st"> </span><span class="kw">nrow</span>(children), ]</a></code></pre></div>
<p>If <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_2\)</span> are a priori independent</p>
<p><span class="math display">\[p(\lambda_1, \lambda_2) = p(\lambda_1)p(\lambda_2)\]</span>
they are also a posteriori independent
<span class="math display">\[p(\lambda_1, \lambda_2|\mathbf{y}) = p(\lambda_1|\mathbf{y})p(\lambda_2|\mathbf{y})\]</span>
and their posteriors
<span class="math display">\[\lambda_1 \sim \mathcal{G}(a_{1n}, b_{1n})\]</span>
<span class="math display">\[\lambda_2 \sim \mathcal{G}(a_{2n}, b_{2n})\]</span>
Determine the parameters of the posterior distributions for <span class="math inline">\(a_1 = a_2=b_1 =b_2= 1\)</span> and visualize the posterior distributions.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># prior before </span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">a1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3">b1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co"># posterior before</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6">y1.mean &lt;-<span class="st"> </span><span class="kw">mean</span>(child.before[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">n1 &lt;-<span class="st"> </span><span class="kw">nrow</span>(child.before)</a>
<a class="sourceLine" id="cb24-8" data-line-number="8"></a>
<a class="sourceLine" id="cb24-9" data-line-number="9">a<span class="fl">.1</span>n &lt;-<span class="st"> </span>a1 <span class="op">+</span><span class="st"> </span>n1 <span class="op">*</span><span class="st"> </span>y1.mean</a>
<a class="sourceLine" id="cb24-10" data-line-number="10">b<span class="fl">.1</span>n &lt;-<span class="st"> </span>b1 <span class="op">+</span><span class="st"> </span>n1</a>
<a class="sourceLine" id="cb24-11" data-line-number="11"></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="co"># prior after</span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13">a2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14">b2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb24-15" data-line-number="15"></a>
<a class="sourceLine" id="cb24-16" data-line-number="16"><span class="co"># posterior after</span></a>
<a class="sourceLine" id="cb24-17" data-line-number="17">y2.mean &lt;-<span class="st"> </span><span class="kw">mean</span>(child.after[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb24-18" data-line-number="18">n2 &lt;-<span class="st"> </span><span class="kw">nrow</span>(child.after)</a>
<a class="sourceLine" id="cb24-19" data-line-number="19"></a>
<a class="sourceLine" id="cb24-20" data-line-number="20">a<span class="fl">.2</span>n &lt;-<span class="st"> </span>a2 <span class="op">+</span><span class="st"> </span>n2 <span class="op">*</span><span class="st"> </span>y2.mean</a>
<a class="sourceLine" id="cb24-21" data-line-number="21">b<span class="fl">.2</span>n &lt;-<span class="st"> </span>b2 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb24-22" data-line-number="22"></a>
<a class="sourceLine" id="cb24-23" data-line-number="23"><span class="co"># Plot posterior</span></a>
<a class="sourceLine" id="cb24-24" data-line-number="24">lam &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb24-25" data-line-number="25">lambda.posterior1 &lt;-<span class="st"> </span><span class="kw">dgamma</span>(lam, <span class="dt">shape =</span> a<span class="fl">.1</span>n , <span class="dt">rate =</span> b<span class="fl">.1</span>n)</a>
<a class="sourceLine" id="cb24-26" data-line-number="26">lambda.posterior2 &lt;-<span class="st"> </span><span class="kw">dgamma</span>(lam, <span class="dt">shape =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n2 <span class="op">*</span><span class="st"> </span>y2.mean, <span class="dt">rate =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n2)</a>
<a class="sourceLine" id="cb24-27" data-line-number="27"></a>
<a class="sourceLine" id="cb24-28" data-line-number="28"><span class="kw">plot</span>(lam, lambda.posterior1, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;lambda&quot;</span>, </a>
<a class="sourceLine" id="cb24-29" data-line-number="29">     <span class="dt">ylab =</span> <span class="st">&quot;Density&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>) , </a>
<a class="sourceLine" id="cb24-30" data-line-number="30">     <span class="dt">main =</span> <span class="st">&quot;Posterior distribution of lambda before/after structural break&quot;</span>)</a>
<a class="sourceLine" id="cb24-31" data-line-number="31"><span class="kw">lines</span>(lam, lambda.posterior2, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>)</a>
<a class="sourceLine" id="cb24-32" data-line-number="32"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Before the structural break&quot;</span>, </a>
<a class="sourceLine" id="cb24-33" data-line-number="33">                              <span class="st">&quot;After the structural break&quot;</span>),</a>
<a class="sourceLine" id="cb24-34" data-line-number="34">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkred&quot;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="Bayes_OeAWSummerschool_Exercises_Solutions_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li>What can you conclude about the effect of the legal amendment?</li>
</ol>
</div>
<div id="exercise-3-midge-data---normal-model-with-known-variance" class="section level2">
<h2><span class="header-section-number">3.3</span> Exercise 3: Midge data - Normal model with known variance</h2>
<p>For a species of midge 9 measurements on the wing length were observed with the goal to make inference on the population mean of the wing length.</p>
<p>The measurements are
<span class="math display">\[1.64, 1.70, 1.72,1.74,1.82,1.82, 1.82, 1.90,2.08\]</span>
A simple stochastic model for these data is that the measurements <span class="math inline">\(y_1, ..., y_n\)</span> are iid. <span class="math inline">\(N(\mu, \sigma^2)\)</span> with unknown population mean <span class="math inline">\(\mu\)</span> and known variance <span class="math inline">\(\sigma^2\)</span> = 0.13^2 = 0.0169. The goal is to perform a Bayesian analysis with a conjugate Normal prior on <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\mu \sim N(m_0, M_0)\)</span>.</p>
<p>RECALL:
When <span class="math inline">\(y_1, ..., y_n\)</span> iid. <span class="math inline">\(N(\mu, \sigma^2)\)</span> with a Normal prior on <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\mu \sim N(m_0, M_0)\)</span> and known <span class="math inline">\(\sigma^2\)</span> &gt; 0 the posterior distribution of <span class="math inline">\(\mu\)</span> is also a Normal distribution <span class="math inline">\(N(m_n, M_n)\)</span> with parameters <span class="math inline">\(M_n\)</span> and <span class="math inline">\(m_n\)</span> given as:
<span class="math display">\[M_n = (\frac{1}{M_0} + \frac{n}{\sigma^2})^{-1}.\]</span>
and
<span class="math display">\[m_n = M_n  (\frac{m_0}{M_0} + \frac{n}{\sigma^2}{\bar{y}}),\]</span>
see slide 44.</p>
<ol style="list-style-type: decimal">
<li>Compute the posterior mean <span class="math inline">\(m_n\)</span> and the posterior variance <span class="math inline">\(M_n\)</span> of <span class="math inline">\(\mu\)</span> for <span class="math inline">\(m_0 = 0\)</span> and <span class="math inline">\(M_0 = 10000\)</span>.</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co">#data</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2">y &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="fl">1.64</span>, <span class="fl">1.70</span>, <span class="fl">1.72</span>, <span class="fl">1.74</span>, <span class="fl">1.82</span>, <span class="fl">1.82</span>, <span class="fl">1.82</span>, <span class="fl">1.90</span>, <span class="fl">2.08</span>) </a>
<a class="sourceLine" id="cb25-3" data-line-number="3">n &lt;-<span class="st"> </span><span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">mean.y &lt;-<span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb25-5" data-line-number="5"></a>
<a class="sourceLine" id="cb25-6" data-line-number="6">sigma &lt;-<span class="st"> </span><span class="fl">0.13</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="co"># set prior parameters</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"></a>
<a class="sourceLine" id="cb25-10" data-line-number="10">M0 &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11">m0 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"></a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="co"># compute posterior parameters</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"></a>
<a class="sourceLine" id="cb25-15" data-line-number="15">Mn &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>M0 <span class="op">+</span><span class="st"> </span>n<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">^-</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16">mn &lt;-<span class="st"> </span>Mn<span class="op">*</span><span class="st"> </span>(m0<span class="op">/</span>M0 <span class="op">+</span><span class="st"> </span>n<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span> <span class="op">*</span>mean.y)</a>
<a class="sourceLine" id="cb25-17" data-line-number="17"></a>
<a class="sourceLine" id="cb25-18" data-line-number="18">mn</a></code></pre></div>
<pre><code>## [1] 1.804444</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">Mn</a></code></pre></div>
<pre><code>## [1] 0.001877777</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Generate a vector mu.draws with 10000 draws from the posterior distribution <span class="math inline">\(N(m_n, M_n)\)</span>.</li>
</ol>
<p>Hint: Use the function rnorm().</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">mu.draws &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10000</span>, <span class="dt">mean =</span> mn, <span class="dt">sd =</span> <span class="kw">sqrt</span>(Mn))</a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Plot the kernel density estimate for the sample of the posterior and compare it with exact posterior density.</li>
</ol>
<p>Hint: A kernel density estimate is generated by the function <em>density()</em> and can be plotted by <em>plot(density(…))</em></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">density</span>(mu.draws), <span class="dt">main =</span> <span class="st">&quot;Posterior distribution&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;wing length&quot;</span>)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="kw">lines</span>(x, <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> mn, <span class="dt">sd =</span> <span class="kw">sqrt</span>(Mn)), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;approx. posterior&quot;</span>, <span class="st">&quot;exact posterior&quot;</span>), </a>
<a class="sourceLine" id="cb30-5" data-line-number="5">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="Bayes_OeAWSummerschool_Exercises_Solutions_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="exercise-4-midge-data---normal-model-mean-and-variance-unknown" class="section level2">
<h2><span class="header-section-number">3.4</span> Exercise 4: Midge data - Normal model, mean and variance unknown</h2>
<p>Perform a conjugate Bayesian analysis of the midge data with a Normal model where both parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> are unknown.</p>
<p>The stochastic model for the 9 measurements is now that <span class="math inline">\(y_i\)</span> are iid. Normal with unkown parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>
<span class="math display">\[y_i \text{ iid. } \sim N(\mu, \sigma^2)\]</span>
RECALL:
If both parameters of the Normal distribution <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> are unknown a joint prior on <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> has to be specified.
A conjugate prior is specified as follows: The prior on <span class="math inline">\(\mu\)</span> conditional on <span class="math inline">\(\sigma^2\)</span> is Normal,
<span class="math display">\[\mu|\sigma^2  \sim N(m_0, \sigma^2 M_0)\]</span>
and the (marginal) prior of <span class="math inline">\(\sigma^2\)</span> is the inverse Gamma distribution
<span class="math display">\[\sigma^2  \sim G^{-1}(\nu_0/2, \nu_0/2 \, \sigma_0^2),\]</span>
see slide 49.</p>
<ol style="list-style-type: decimal">
<li>Write a program to sample from the joint prior distribution of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> by sampling from the distributions <span class="math inline">\(p(\mu|\sigma^2)\)</span> and <span class="math inline">\(p(\sigma^2)\)</span></li>
</ol>
<p>Set the prior parameters first to <span class="math inline">\(m_0=1.9\)</span>,<span class="math inline">\(M_0=1\)</span>, <span class="math inline">\(\nu_0=1\)</span> and <span class="math inline">\(\sigma^2_0=0.01\)</span> and plot the draws (you might want to “zoom in” when you do the plot by setting xlim and ylim in a proper way).</p>
<p>HINT:
Use the function <em>rinvgamma()</em> from the package “invgamma” to sample from the inverse Gamma distribution.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">library</span>(invgamma)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="co"># set prior parameters</span></a>
<a class="sourceLine" id="cb31-4" data-line-number="4">m0 &lt;-<span class="st"> </span><span class="fl">1.9</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5">M0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb31-6" data-line-number="6">nu<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7">sigma2<span class="fl">.0</span> &lt;-<span class="fl">0.01</span></a>
<a class="sourceLine" id="cb31-8" data-line-number="8"></a>
<a class="sourceLine" id="cb31-9" data-line-number="9"><span class="co"># set number of draws </span></a>
<a class="sourceLine" id="cb31-10" data-line-number="10">nsim &lt;-<span class="st"> </span><span class="dv">10000</span> </a>
<a class="sourceLine" id="cb31-11" data-line-number="11"></a>
<a class="sourceLine" id="cb31-12" data-line-number="12"><span class="co"># generate draws</span></a>
<a class="sourceLine" id="cb31-13" data-line-number="13">sigma2.draws &lt;-<span class="st"> </span><span class="kw">rinvgamma</span>(nsim, nu<span class="fl">.0</span><span class="op">/</span><span class="dv">2</span>, nu<span class="fl">.0</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sigma2<span class="fl">.0</span>)</a>
<a class="sourceLine" id="cb31-14" data-line-number="14">mu.draws &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsim, <span class="dt">mean =</span> m0, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>sigma2.draws))</a>
<a class="sourceLine" id="cb31-15" data-line-number="15"></a>
<a class="sourceLine" id="cb31-16" data-line-number="16"><span class="co"># plot </span></a>
<a class="sourceLine" id="cb31-17" data-line-number="17"><span class="kw">plot</span>(mu.draws, sigma2.draws)</a></code></pre></div>
<p><img src="Bayes_OeAWSummerschool_Exercises_Solutions_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co"># zoom in</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="kw">plot</span>(mu.draws, sigma2.draws, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))</a></code></pre></div>
<p><img src="Bayes_OeAWSummerschool_Exercises_Solutions_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Write a program to sample from the posterior distribution by sampling <span class="math inline">\(\sigma^2\)</span> from <span class="math inline">\(p(\sigma^2|\mathbf{y})\)</span> and <span class="math inline">\(\mu\)</span> from <span class="math inline">\(p(\mu|\sigma^2,\mathbf{y})\)</span>.</li>
</ol>
<p>RECALL:
Under the conjugate prior for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> the marginal posterior of <span class="math inline">\(\sigma^2\)</span> is Inverse Gamma
<span class="math display">\[\sigma^2 | \textbf{y} \sim G^{-1}(\frac{\nu_n}{2}, \frac{\nu_n}{2} \sigma^2_n)\]</span>
and the conditional posterior of <span class="math inline">\(\mu\)</span> is Normal
<span class="math display">\[\mu| \sigma^2, \textbf{y} \sim N(m_n, M_n \sigma^2)\]</span></p>
<p>Formulas for the posterior parameters <span class="math inline">\(\nu_n, \sigma^2_n, m_n, M_n\)</span> are given on slide 51.</p>
<p>HOW TO PROCEED:</p>
<ul>
<li><p>Create variables for the number of observations n and the data mean</p></li>
<li><p>Set the prior parameters</p></li>
<li><p>Create two empty variables sigma.draws and mu.draws</p></li>
<li><p>Determine the posterior parameters</p></li>
<li><p>Sample <span class="math inline">\(M\)</span> values from <span class="math inline">\(p(\sigma^2|\mathbf{y})\)</span></p></li>
<li><p>Sample <span class="math inline">\(M\)</span> values from <span class="math inline">\(p(\mu|\sigma^2,\mathbf{y})\)</span> using the sampled values of <span class="math inline">\(\sigma^2\)</span></p></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co">#Determine n and mean of y</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.64</span>, <span class="fl">1.70</span>, <span class="fl">1.72</span>, <span class="fl">1.74</span>, <span class="fl">1.82</span>, <span class="fl">1.82</span>, <span class="fl">1.82</span>, <span class="fl">1.90</span>, <span class="fl">2.08</span>)</a>
<a class="sourceLine" id="cb33-3" data-line-number="3"></a>
<a class="sourceLine" id="cb33-4" data-line-number="4">n &lt;-<span class="st"> </span><span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb33-5" data-line-number="5">meany &lt;-<span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb33-6" data-line-number="6"></a>
<a class="sourceLine" id="cb33-7" data-line-number="7"><span class="co"># set prior parameters</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8">m0 &lt;-<span class="st"> </span><span class="fl">1.9</span></a>
<a class="sourceLine" id="cb33-9" data-line-number="9">M0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10">nu<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11">sigma2<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="fl">0.01</span></a>
<a class="sourceLine" id="cb33-12" data-line-number="12"></a>
<a class="sourceLine" id="cb33-13" data-line-number="13"><span class="co"># set number of draws</span></a>
<a class="sourceLine" id="cb33-14" data-line-number="14">M &lt;-<span class="st"> </span><span class="dv">10000</span> </a>
<a class="sourceLine" id="cb33-15" data-line-number="15"></a>
<a class="sourceLine" id="cb33-16" data-line-number="16"><span class="co"># sample sigma2</span></a>
<a class="sourceLine" id="cb33-17" data-line-number="17">nu.n &lt;-<span class="st"> </span>nu<span class="fl">.0</span> <span class="op">+</span><span class="st"> </span>n</a>
<a class="sourceLine" id="cb33-18" data-line-number="18">sigma2.n &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>nu.n <span class="op">*</span><span class="st"> </span>(nu<span class="fl">.0</span> <span class="op">*</span><span class="st"> </span>sigma2<span class="fl">.0</span> <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>((y<span class="op">-</span>meany)<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-19" data-line-number="19"><span class="st">            </span><span class="dv">1</span><span class="op">/</span>(M0 <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>n) <span class="op">*</span><span class="st"> </span>(meany <span class="op">-</span><span class="st"> </span>m0)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb33-20" data-line-number="20"></a>
<a class="sourceLine" id="cb33-21" data-line-number="21">sigma2.draws &lt;-<span class="st"> </span><span class="kw">rinvgamma</span>(M, nu.n<span class="op">/</span><span class="dv">2</span>, nu.n<span class="op">/</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sigma2.n)</a>
<a class="sourceLine" id="cb33-22" data-line-number="22"></a>
<a class="sourceLine" id="cb33-23" data-line-number="23"><span class="co"># sample mu  </span></a>
<a class="sourceLine" id="cb33-24" data-line-number="24">Mn &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>M0 <span class="op">+</span><span class="st"> </span>n)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-25" data-line-number="25">mn &lt;-<span class="st"> </span>Mn <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>M0 <span class="op">*</span><span class="st"> </span>m0 <span class="op">+</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span>meany)</a>
<a class="sourceLine" id="cb33-26" data-line-number="26">  </a>
<a class="sourceLine" id="cb33-27" data-line-number="27">mu.draws &lt;-<span class="st"> </span><span class="kw">rnorm</span>(M, <span class="dt">mean =</span> mn, <span class="dt">sd =</span> <span class="kw">sqrt</span>(sigma2.draws <span class="op">*</span><span class="st"> </span>Mn))</a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Plot the sampled values and compare to the prior distribution.</li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">plot</span>(mu.draws, sigma2.draws, <span class="dt">xlab =</span> <span class="st">&quot;mu&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;sigma2&quot;</span>)</a></code></pre></div>
<p><img src="Bayes_OeAWSummerschool_Exercises_Solutions_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Use the draws from the posterior to approximate the posterior mean and variance of the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>.</li>
</ol>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">mean</span>(mu.draws)</a></code></pre></div>
<pre><code>## [1] 1.813741</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">var</span>(mu.draws)</a></code></pre></div>
<pre><code>## [1] 0.001885904</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">mean</span>(sigma2.draws)</a></code></pre></div>
<pre><code>## [1] 0.01894262</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">var</span>(sigma2.draws)</a></code></pre></div>
<pre><code>## [1] 0.0001109309</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Plot the approximation of the marginal posterior of the mean wing length.</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">density</span>(mu.draws), <span class="dt">xlab =</span> <span class="st">&quot;mu&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;pdf&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Marginal posterior of mu&quot;</span>) </a></code></pre></div>
<p><img src="Bayes_OeAWSummerschool_Exercises_Solutions_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Advanced task: Perform a sensitivity analysis to investigate how the results change with the prior parameters.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="short-recap.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mcmc-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
